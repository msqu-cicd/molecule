FROM docker:rc-dind

RUN apk update && \
    apk add --no-cache \
    python3 python3-dev py3-pip gcc git curl build-base bash \
    autoconf automake py3-cryptography linux-headers \
    musl-dev libffi-dev openssl-dev openssh-client-common sudo \
    && pip3 --no-cache-dir install ansible jmespath molecule[docker] molecule-hetznercloud netaddr yamllint \
    && mkdir -p ~/.ansible/plugins/modules \
    && curl -o ~/.ansible/plugins/modules/aur.py https://raw.githubusercontent.com/kewlfft/ansible-aur/master/plugins/modules/aur.py
